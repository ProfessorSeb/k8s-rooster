apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    argocd.argoproj.io/tracking-id: enterprise-agentgateway-helm:apps/Deployment:agentgateway-system/enterprise-agentgateway
  labels:
    agentgateway: agentgateway
    app.kubernetes.io/instance: enterprise-agentgateway-helm
    app.kubernetes.io/managed-by: Helm
    app.kubernetes.io/name: enterprise-agentgateway
    app.kubernetes.io/version: 2.1.0
    helm.sh/chart: enterprise-agentgateway-2.1.0
  name: enterprise-agentgateway
  namespace: agentgateway-system
spec:
  progressDeadlineSeconds: 600
  replicas: 1
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      agentgateway: agentgateway
      app.kubernetes.io/instance: enterprise-agentgateway-helm
      app.kubernetes.io/name: enterprise-agentgateway
  strategy:
    rollingUpdate:
      maxSurge: 25%
      maxUnavailable: 25%
    type: RollingUpdate
  template:
    metadata:
      annotations:
        checksum/licensing-secret: 83b9f3d3c7cf4bc79839b4a312a6cf9c1494c8149538b419c089adc5dcecaf16
        prometheus.io/path: /metrics
        prometheus.io/port: '9092'
        prometheus.io/scrape: 'true'
      labels:
        agentgateway: agentgateway
        app.kubernetes.io/instance: enterprise-agentgateway-helm
        app.kubernetes.io/name: enterprise-agentgateway
    spec:
      containers:
      - env:
        - name: ENTERPRISE_AGENTGATEWAY_LICENSE_KEY
          valueFrom:
            secretKeyRef:
              key: enterprise-agentgateway-license-key
              name: enterprise-agentgateway-license
              optional: true
        - name: GOMEMLIMIT
          valueFrom:
            resourceFieldRef:
              divisor: '1'
              resource: limits.memory
        - name: GOMAXPROCS
          valueFrom:
            resourceFieldRef:
              divisor: '1'
              resource: limits.cpu
        - name: KGW_LOG_LEVEL
          value: info
        - name: KGW_XDS_SERVICE_NAME
          value: enterprise-agentgateway
        - name: KGW_AGENTGATEWAY_XDS_SERVICE_PORT
          value: '9978'
        - name: KGW_DEFAULT_IMAGE_REGISTRY
          value: us-docker.pkg.dev/solo-public/enterprise-agentgateway
        - name: KGW_DEFAULT_IMAGE_TAG
          value: 2.1.0
        - name: KGW_DEFAULT_IMAGE_PULL_POLICY
          value: IfNotPresent
        - name: KGW_DISCOVERY_NAMESPACE_SELECTORS
          value: '[]'
        - name: KGW_ENABLE_AGENTGATEWAY
          value: 'true'
        - name: KGW_ENABLE_ENVOY
          value: 'false'
        - name: KGW_GATEWAY_CLASS_PARAMETERS_REFS
          value: '{}'
        - name: POD_NAMESPACE
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: metadata.namespace
        image: us-docker.pkg.dev/solo-public/enterprise-agentgateway/enterprise-agentgateway-controller:2.1.0
        imagePullPolicy: Always
        name: controller
        ports:
        - containerPort: 9978
          name: grpc-xds-agw
          protocol: TCP
        - containerPort: 9093
          name: health
          protocol: TCP
        - containerPort: 9092
          name: metrics
          protocol: TCP
        readinessProbe:
          failureThreshold: 3
          httpGet:
            path: /readyz
            port: 9093
            scheme: HTTP
          initialDelaySeconds: 1
          periodSeconds: 10
          successThreshold: 1
          timeoutSeconds: 1
        resources: {}
        startupProbe:
          failureThreshold: 120
          httpGet:
            path: /readyz
            port: 9093
            scheme: HTTP
          periodSeconds: 1
          successThreshold: 1
          timeoutSeconds: 1
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
      dnsPolicy: ClusterFirst
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext: {}
      serviceAccount: enterprise-agentgateway
      serviceAccountName: enterprise-agentgateway
      terminationGracePeriodSeconds: 30

---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations: {}
  labels:
    app: ext-auth-service
    gateway.solo.io/extension: agw-ext-auth
    gateway.solo.io/gatewayclass: enterprise-agentgateway
  name: ext-auth-service-enterprise-agentgateway
  namespace: agentgateway-system
spec:
  progressDeadlineSeconds: 600
  replicas: 1
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app: ext-auth-service
      app.kubernetes.io/instance: ext-auth-service-enterprise-agentgateway
  strategy:
    rollingUpdate:
      maxSurge: 25%
      maxUnavailable: 25%
    type: RollingUpdate
  template:
    metadata:
      annotations:
        prometheus.io/path: /metrics
        prometheus.io/port: '9091'
        prometheus.io/scrape: 'true'
      labels:
        app: ext-auth-service
        app.kubernetes.io/instance: ext-auth-service-enterprise-agentgateway
    spec:
      containers:
      - env:
        - name: LOG_LEVEL
          value: info
        - name: START_STATS_SERVER
          value: 'true'
        - name: LEADER_ELECTION_ENABLED
          value: 'true'
        - name: WATCH_NAMESPACE
        - name: SECRETS_NAMESPACES
        - name: SERVER_PORT
          value: '8083'
        - name: DEBUG_PORT
          value: '9091'
        - name: USER_ID_HEADER
        - name: PLUGIN_DIRECTORY
          value: /auth-plugins/
        - name: HEADERS_TO_REDACT
          value: '"authorization"'
        - name: HEALTH_FAIL_TIMEOUT
          value: '15'
        - name: HEALTH_HTTP_PATH
          value: /healthcheck
        - name: HEALTH_HTTP_PORT
          value: '8082'
        - name: HEALTH_LIVENESS_HTTP_PATH
          value: /livenesscheck
        - name: APIKEY_METADATA_TO_STATE
          value: 'false'
        - name: SIGNING_KEY
          valueFrom:
            secretKeyRef:
              key: signing-key
              name: ext-auth-service-signing-key-enterprise-agentgateway
        image: gcr.io/gloo-mesh/ext-auth-service:0.71.4
        imagePullPolicy: IfNotPresent
        livenessProbe:
          failureThreshold: 3
          httpGet:
            path: /livenesscheck
            port: 8082
            scheme: HTTP
          initialDelaySeconds: 3
          periodSeconds: 10
          successThreshold: 1
          timeoutSeconds: 1
        name: ext-auth-service
        readinessProbe:
          failureThreshold: 3
          httpGet:
            path: /healthcheck
            port: 8082
            scheme: HTTP
          initialDelaySeconds: 1
          periodSeconds: 5
          successThreshold: 1
          timeoutSeconds: 1
        resources:
          requests:
            cpu: 100m
            memory: 128Mi
        securityContext:
          allowPrivilegeEscalation: false
          capabilities:
            drop:
            - ALL
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
      dnsPolicy: ClusterFirst
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext:
        runAsUser: 10101
      serviceAccount: ext-auth-service-enterprise-agentgateway
      serviceAccountName: ext-auth-service-enterprise-agentgateway
      terminationGracePeriodSeconds: 30

---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations: {}
  labels:
    app: ext-cache
    gateway.solo.io/extension: agw-ext-cache
    gateway.solo.io/gatewayclass: enterprise-agentgateway
  name: ext-cache-enterprise-agentgateway
  namespace: agentgateway-system
spec:
  progressDeadlineSeconds: 600
  replicas: 1
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app: ext-cache
      ext-cache: redis
  strategy:
    rollingUpdate:
      maxSurge: 25%
      maxUnavailable: 25%
    type: RollingUpdate
  template:
    metadata:
      labels:
        app: ext-cache
        ext-cache: redis
    spec:
      containers:
      - env:
        - name: MASTER
          value: 'true'
        image: docker.io/redis:7.2.12-alpine
        imagePullPolicy: IfNotPresent
        name: redis
        ports:
        - containerPort: 6379
          protocol: TCP
        readinessProbe:
          failureThreshold: 3
          initialDelaySeconds: 15
          periodSeconds: 10
          successThreshold: 1
          tcpSocket:
            port: 6379
          timeoutSeconds: 1
        resources:
          requests:
            cpu: 100m
            memory: 128Mi
        securityContext:
          allowPrivilegeEscalation: false
          capabilities:
            drop:
            - ALL
          readOnlyRootFilesystem: true
          runAsNonRoot: true
          runAsUser: 999
        startupProbe:
          exec:
            command:
            - redis-cli
            - ping
          failureThreshold: 3
          initialDelaySeconds: 5
          periodSeconds: 10
          successThreshold: 1
          timeoutSeconds: 1
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        volumeMounts:
        - mountPath: /redis-master-data
          name: data
      dnsPolicy: ClusterFirst
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext: {}
      serviceAccount: ext-cache-agentgateway-system-enterprise-agentgateway
      serviceAccountName: ext-cache-agentgateway-system-enterprise-agentgateway
      terminationGracePeriodSeconds: 30
      volumes:
      - emptyDir: {}
        name: data

---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations: {}
  labels:
    app.kubernetes.io/instance: ollama-gateway
    app.kubernetes.io/managed-by: kgateway
    app.kubernetes.io/name: ollama-gateway
    gateway.networking.k8s.io/gateway-class-name: enterprise-agentgateway
    gateway.networking.k8s.io/gateway-name: ollama-gateway
    kgateway: kube-gateway
  name: ollama-gateway
  namespace: agentgateway-system
  ownerReferences:
  - apiVersion: gateway.networking.k8s.io/v1
    controller: true
    kind: Gateway
    name: ollama-gateway
    uid: b9ab1e9d-b64d-44f4-b69f-46fb10fc0349
spec:
  progressDeadlineSeconds: 600
  replicas: 1
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app.kubernetes.io/instance: ollama-gateway
      app.kubernetes.io/name: ollama-gateway
      gateway.networking.k8s.io/gateway-name: ollama-gateway
  strategy:
    rollingUpdate:
      maxSurge: 25%
      maxUnavailable: 25%
    type: RollingUpdate
  template:
    metadata:
      annotations:
        checksum/config: 8903d296ac1eb694c199851174434d407a5b53d04da864d66db01ca0d422d22d
        prometheus.io/path: /metrics
        prometheus.io/port: '15020'
        prometheus.io/scrape: 'true'
      labels:
        app.kubernetes.io/instance: ollama-gateway
        app.kubernetes.io/name: ollama-gateway
        gateway.networking.k8s.io/gateway-class-name: enterprise-agentgateway
        gateway.networking.k8s.io/gateway-name: ollama-gateway
    spec:
      containers:
      - args:
        - -f
        - /config/config.yaml
        env:
        - name: TERMINATION_GRACE_PERIOD_SECONDS
          value: '60'
        - name: CONNECTION_MIN_TERMINATION_DEADLINE
          value: 10s
        - name: NODE_NAME
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: metadata.name
        - name: POD_NAMESPACE
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: metadata.namespace
        - name: POD_NAME
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: metadata.name
        - name: RUST_BACKTRACE
          value: '1'
        - name: RUST_LOG
          value: info
        - name: XDS_ADDRESS
          value: http://enterprise-agentgateway.agentgateway-system.svc.cluster.local:9978
        - name: NAMESPACE
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: metadata.namespace
        - name: GATEWAY
          value: ollama-gateway
        - name: CPU_LIMIT
          valueFrom:
            resourceFieldRef:
              divisor: '1'
              resource: limits.cpu
        - name: INSTANCE_IP
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: status.podIP
        - name: SERVICE_ACCOUNT
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: spec.serviceAccountName
        - name: OTEL_EXPORTER_OTLP_ENDPOINT
          value: http://opentelemetry-collector-traces.telemetry.svc.cluster.local:4317
        - name: OTEL_TRACES_EXPORTER
          value: otlp
        - name: OTEL_SERVICE_NAME
          value: ollama-gateway
        image: ghcr.io/solo-io/agentgateway-enterprise:0.11.1-patch1
        imagePullPolicy: IfNotPresent
        name: agentgateway
        ports:
        - containerPort: 15020
          name: metrics
          protocol: TCP
        readinessProbe:
          failureThreshold: 3
          httpGet:
            path: /healthz/ready
            port: 15021
            scheme: HTTP
          periodSeconds: 10
          successThreshold: 1
          timeoutSeconds: 1
        resources: {}
        securityContext:
          allowPrivilegeEscalation: false
          capabilities:
            drop:
            - ALL
          readOnlyRootFilesystem: true
          runAsNonRoot: true
          runAsUser: 10101
        startupProbe:
          failureThreshold: 60
          httpGet:
            path: /healthz/ready
            port: 15021
            scheme: HTTP
          periodSeconds: 1
          successThreshold: 1
          timeoutSeconds: 2
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        volumeMounts:
        - mountPath: /config
          name: config-volume
        - mountPath: /tmp
          name: tmp
        - mountPath: /var/run/secrets/xds-tokens
          name: xds-token
          readOnly: true
      dnsPolicy: ClusterFirst
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext:
        sysctls:
        - name: net.ipv4.ip_unprivileged_port_start
          value: '0'
      serviceAccount: ollama-gateway
      serviceAccountName: ollama-gateway
      terminationGracePeriodSeconds: 60
      volumes:
      - configMap:
          defaultMode: 420
          name: ollama-gateway
        name: config-volume
      - name: xds-token
        projected:
          defaultMode: 420
          sources:
          - serviceAccountToken:
              audience: kgateway
              expirationSeconds: 43200
              path: xds-token
      - emptyDir: {}
        name: tmp

---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations: {}
  labels:
    app: rate-limiter
    gateway.solo.io/extension: agw-rate-limiter
    gateway.solo.io/gatewayclass: enterprise-agentgateway
  name: rate-limiter-enterprise-agentgateway
  namespace: agentgateway-system
spec:
  progressDeadlineSeconds: 600
  replicas: 1
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app: rate-limiter
      rate-limiter: rate-limiter
  strategy:
    rollingUpdate:
      maxSurge: 25%
      maxUnavailable: 25%
    type: RollingUpdate
  template:
    metadata:
      annotations:
        prometheus.io/path: /metrics
        prometheus.io/port: '9091'
        prometheus.io/scrape: 'true'
      labels:
        app: rate-limiter
        rate-limiter: rate-limiter
    spec:
      containers:
      - env:
        - name: LOG_LEVEL
          value: INFO
        - name: START_STATS_SERVER
          value: 'true'
        - name: POD_NAMESPACE
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: metadata.namespace
        - name: POD_UID
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: metadata.uid
        - name: RL_PORT_GRPC
          value: '8083'
        - name: READY_PORT_HTTP
          value: '8084'
        - name: DEBUG_PORT
          value: '9091'
        - name: REDIS_DB
          value: '0'
        - name: REDIS_URL
          value: ext-cache-enterprise-agentgateway:6379
        - name: REDIS_SOCKET_TYPE
          value: tcp
        - name: READY_PATH_HTTP
          value: /ready
        - name: ALIVE_PATH_HTTP
        - name: TRACING_SERVICE_NAME
          value: RateLimit
        - name: TRACING_SERVICE_NAMESPACE
          value: agentgateway-system
        - name: TRACING_EXPORTER_PROTOCOL
          value: grpc
        - name: TRACING_SAMPLING_RATE
          value: '0.1'
        image: gcr.io/gloo-mesh/rate-limiter:0.17.2
        imagePullPolicy: IfNotPresent
        name: rate-limiter
        readinessProbe:
          failureThreshold: 3
          httpGet:
            path: /ready
            port: 8084
            scheme: HTTP
          initialDelaySeconds: 1
          periodSeconds: 5
          successThreshold: 1
          timeoutSeconds: 1
        resources:
          requests:
            cpu: 100m
            memory: 128Mi
        securityContext:
          allowPrivilegeEscalation: false
          capabilities:
            drop:
            - ALL
          readOnlyRootFilesystem: true
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
      dnsPolicy: ClusterFirst
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext: {}
      serviceAccount: rate-limiter-agentgateway-system-enterprise-agentgateway
      serviceAccountName: rate-limiter-agentgateway-system-enterprise-agentgateway
      terminationGracePeriodSeconds: 30

---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    meta.helm.sh/release-name: management
    meta.helm.sh/release-namespace: agentgateway-system
  labels:
    app.kubernetes.io/managed-by: Helm
  name: solo-enterprise-ui
  namespace: agentgateway-system
spec:
  progressDeadlineSeconds: 600
  replicas: 1
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      app: solo-enterprise-ui
  strategy:
    type: Recreate
  template:
    metadata:
      labels:
        app: solo-enterprise-ui
    spec:
      containers:
      - args:
        - --port
        - '9000'
        - --kube-api-proxy-port
        - '9990'
        - --reverse-proxy-port
        - '9991'
        - --metrics-port
        - '8080'
        - --enable-cluster-router
        image: us-docker.pkg.dev/solo-public/solo-enterprise/solo-enterprise-tunnel-server:0.3.2
        imagePullPolicy: IfNotPresent
        livenessProbe:
          failureThreshold: 3
          httpGet:
            path: /healthz
            port: 8080
            scheme: HTTP
          initialDelaySeconds: 10
          periodSeconds: 10
          successThreshold: 1
          timeoutSeconds: 5
        name: tunnel-server
        ports:
        - containerPort: 9000
          protocol: TCP
        - containerPort: 9990
          protocol: TCP
        - containerPort: 9991
          protocol: TCP
        - containerPort: 8080
          protocol: TCP
        readinessProbe:
          failureThreshold: 3
          httpGet:
            path: /healthz
            port: 8080
            scheme: HTTP
          initialDelaySeconds: 5
          periodSeconds: 10
          successThreshold: 1
          timeoutSeconds: 5
        resources:
          limits:
            cpu: 500m
            memory: 1Gi
          requests:
            cpu: 250m
            memory: 512Mi
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
      - env:
        - name: UI_BACKEND_HOST
        - name: CLIENT_ID
          value: kagent-ui
        - name: OIDC_ISSUER
          value: http://solo-enterprise-ui.agentgateway-system.svc.cluster.local:5556
        - name: LOCAL_CLUSTER_NAME
          value: maniak-rooster
        - name: INSTALLED_VERSION
          value: 0.3.2
        - name: ENABLE_MOCK_UI
          value: 'false'
        - name: ADDITIONAL_OIDC_SCOPES
        - name: PRODUCT_AGENTGATEWAY_ENT_ENABLED
          value: 'true'
        - name: AUTO_AUTH_ENABLED
          value: 'true'
        image: us-docker.pkg.dev/solo-public/solo-enterprise/solo-enterprise-ui-frontend:0.3.2
        imagePullPolicy: IfNotPresent
        livenessProbe:
          failureThreshold: 3
          httpGet:
            path: /
            port: 4000
            scheme: HTTP
          initialDelaySeconds: 10
          periodSeconds: 10
          successThreshold: 1
          timeoutSeconds: 5
        name: ui-frontend
        ports:
        - containerPort: 4000
          protocol: TCP
        readinessProbe:
          failureThreshold: 3
          httpGet:
            path: /
            port: 4000
            scheme: HTTP
          initialDelaySeconds: 5
          periodSeconds: 10
          successThreshold: 1
          timeoutSeconds: 5
        resources:
          limits:
            cpu: 500m
            memory: 1Gi
          requests:
            cpu: 250m
            memory: 512Mi
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
      - env:
        - name: LOCAL_CLUSTER_NAME
          value: maniak-rooster
        - name: MY_POD_IP
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: status.podIP
        - name: KAGENT_ENTERPRISE_UI_SERVICE_PORT_PROXY
          value: '9991'
        - name: KAGENT_ENTERPRISE_UI_OIDC_ISSUER
          value: http://solo-enterprise-ui.agentgateway-system.svc.cluster.local:5556
        - name: KAGENT_ENTERPRISE_UI_OIDC_CLIENT_ID
          value: kagent-backend
        - name: POD_NAMESPACE
          value: agentgateway-system
        - name: CLICKHOUSE_ADDRESS
          value: management-clickhouse
        - name: KAGENT_TUNNEL_METRICS_ADDR
          value: http://localhost:8080
        - name: PRODUCT_AGENTGATEWAY_ENT_ENABLED
          value: 'true'
        - name: AUTO_AUTH_ENABLED
          value: 'true'
        image: us-docker.pkg.dev/solo-public/solo-enterprise/solo-enterprise-ui-backend:0.3.2
        imagePullPolicy: IfNotPresent
        livenessProbe:
          failureThreshold: 3
          httpGet:
            path: /healthz
            port: 8090
            scheme: HTTP
          initialDelaySeconds: 10
          periodSeconds: 10
          successThreshold: 1
          timeoutSeconds: 5
        name: ui-backend
        ports:
        - containerPort: 8090
          protocol: TCP
        - containerPort: 8091
          protocol: TCP
        readinessProbe:
          failureThreshold: 3
          httpGet:
            path: /healthz
            port: 8090
            scheme: HTTP
          initialDelaySeconds: 5
          periodSeconds: 10
          successThreshold: 1
          timeoutSeconds: 5
        resources:
          limits:
            cpu: 500m
            memory: 1Gi
          requests:
            cpu: 250m
            memory: 512Mi
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
      - args:
        - --config=/conf/relay.yaml
        - --feature-gates=clickhouse.json
        env:
        - name: MY_POD_IP
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: status.podIP
        - name: KUBE_NODE_NAME
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: spec.nodeName
        - name: KUBE_POD_NAME
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: metadata.name
        image: docker.io/otel/opentelemetry-collector-contrib:0.132.1
        imagePullPolicy: IfNotPresent
        livenessProbe:
          failureThreshold: 3
          httpGet:
            path: /
            port: 13133
            scheme: HTTP
          initialDelaySeconds: 10
          periodSeconds: 10
          successThreshold: 1
          timeoutSeconds: 5
        name: k8sobjects-collector
        ports:
        - containerPort: 13133
          name: health
          protocol: TCP
        - containerPort: 8888
          name: metrics
          protocol: TCP
        readinessProbe:
          failureThreshold: 3
          httpGet:
            path: /
            port: 13133
            scheme: HTTP
          initialDelaySeconds: 5
          periodSeconds: 10
          successThreshold: 1
          timeoutSeconds: 5
        resources:
          limits:
            cpu: 300m
            memory: 768Mi
          requests:
            cpu: 100m
            memory: 384Mi
        securityContext: {}
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        volumeMounts:
        - mountPath: /conf
          name: solo-enterprise-k8sobjects-config
      - env:
        - name: PORT
          value: '5556'
        - name: ISSUER
          value: http://solo-enterprise-ui.agentgateway-system.svc.cluster.local:5556
        image: us-docker.pkg.dev/solo-public/solo-enterprise/solo-enterprise-idp:0.3.2
        imagePullPolicy: IfNotPresent
        livenessProbe:
          failureThreshold: 3
          httpGet:
            path: /.well-known/openid-configuration
            port: 5556
            scheme: HTTP
          initialDelaySeconds: 10
          periodSeconds: 10
          successThreshold: 1
          timeoutSeconds: 5
        name: idp
        ports:
        - containerPort: 5556
          protocol: TCP
        readinessProbe:
          failureThreshold: 3
          httpGet:
            path: /.well-known/openid-configuration
            port: 5556
            scheme: HTTP
          initialDelaySeconds: 10
          periodSeconds: 10
          successThreshold: 1
          timeoutSeconds: 5
        resources:
          limits:
            cpu: 250m
            memory: 512Mi
          requests:
            cpu: 100m
            memory: 256Mi
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
      dnsPolicy: ClusterFirst
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext: {}
      serviceAccount: solo-enterprise-ui
      serviceAccountName: solo-enterprise-ui
      terminationGracePeriodSeconds: 30
      volumes:
      - configMap:
          defaultMode: 420
          items:
          - key: relay
            path: relay.yaml
          name: solo-enterprise-k8sobjects-config
        name: solo-enterprise-k8sobjects-config
